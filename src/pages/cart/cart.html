<!--
  Generated template for the Cart page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-navbar>
    <ion-title text-center>CARRITO<button ion-button clear *ngIf="!cart.quantity" class="invisibleButton"></button></ion-title>
    <ion-buttons right>
      <button ion-button icon-only *ngIf="cart.quantity > 0" (click)="edit()" class="text-primary edit">
        {{textEditButton}}
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content no-padding>
  <div *ngIf="!cart.quantity">
    <ion-grid>
      <div class="spacer-25"></div>
      <div class="spacer-25"></div>
      <div class="spacer-25"></div>
      <ion-row>
        <ion-col>
          <ion-label text-center class="text-primary font-big">Ups!</ion-label>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col>
          <ion-label text-center class="text-gray-normal font-small-normal">Tu carrito de compras está vacío.</ion-label>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col (click)="goTo()">
          <ion-label text-center class="text-primary font-small-normal">Comprar</ion-label>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
  <div *ngIf="cart.quantity > 0">
    <div class="sub-header">
      <ion-label>{{cart.quantity}} CÓDIGOS CON FLUZ TOTAL: <b>+{{cart.total_fluz/2}}</b></ion-label>
    </div>
    <ion-grid class="font-small text-dark" no-padding *ngFor="let item of products">
      <div>
        <div class="back-options">
          <div class="ctn-edit-options" [style.z-index]="index">
            <div class="ctn-button-option" (click)="removeProduct(item.id_product)">
              <ion-icon class="edit-option" color="primary" name="ios-close-circle"></ion-icon>      
            </div>
            <div class="ctn-button-option" (click)="updateQuantity(0,item.id_product)">
              <ion-icon class="edit-option" name="ios-remove-circle-outline"></ion-icon>
            </div>
            <div class="ctn-button-option background-soft ">
              <ion-label>{{item.quantity}}</ion-label>
            </div>
            <div class="ctn-button-option" (click)="updateQuantity(1,item.id_product)">
              <ion-icon class="edit-option" name="ios-add-circle-outline"></ion-icon>
            </div>
          </div>
          <div class="swipeable" [style.margin-left]="displayOptions">
            <ion-row side="left" class="border-b padding-h-5 margin-t-5 background-white">
              <ion-col class="background-white">
                <div class="image-product">
                  <img src="{{item.image_manufacturer}}">          
                </div>
              </ion-col>
              <ion-col class="product-name background-white">
                <ion-label class="font-semi-bold">{{item.name}}</ion-label>
              </ion-col>
              <ion-col>
                <ion-label class="font-more-small font-semi-bold padding-h-5" text-right>Cantidad</ion-label>
                <ion-label class="font-small font-semi-bold padding-h-5" text-right>{{item.quantity}}</ion-label>
              </ion-col>
            </ion-row>
          </div>
        </div>
        <div *ngIf="item.reference.indexOf('MOV-')!=-1" class="block-phone-telco">
          <ion-row class="border-b">
            <ion-col col-10 *ngIf="showPhones">
              <ion-item>
                <ion-label col-4 text-center class="font-more-small font-semi-bold padding-5">Número a recargar:</ion-label>
                <ion-select col-8 okText="OK" cancelText="Cancelar" placeholder="Teléfono" [(ngModel)]="phonesRecharged[item.id_product]">
                  <ion-option *ngFor="let phone of phones" [value]="phone.phone_mobile">{{phone.phone_mobile}}</ion-option>
                </ion-select>
              </ion-item>
            </ion-col>
            <ion-col col-10 *ngIf="!showPhones">
              <ion-item>
                <ion-label col-10 text-center class="font-small font-semi-bold padding-5">Agregar un número</ion-label>
              </ion-item>
            </ion-col>
            <ion-col col-2 text-center>
              <ion-icon name="add-circle" (click)="addNewPhone(item.id_product)"></ion-icon>
            </ion-col>
          </ion-row>
        </div>
        <div>
          <ion-row class="font-more-small text-gray-normal titles padding-h-5">
            <ion-col col-3 text-left>Valor En Tienda</ion-col>
            <ion-col col-3 text-left>Fluz a Recibir</ion-col>
            <ion-col col-3 text-left>Precio En Fluz</ion-col>
            <ion-col col-3 text-left>Precio</ion-col>
          </ion-row>
          <ion-row class="padding-5">
            <ion-col col-3 text-left>${{item.app_price_shop}}</ion-col>
            <ion-col col-3 text-left>+{{item.points}}</ion-col>
            <ion-col col-3 text-left>{{item.price_in_points}}</ion-col>
            <ion-col col-3 text-left>${{item.total}}</ion-col>
          </ion-row>
          <ion-row class="ctn-terms padding-h-5">
            <ion-col>
              <ion-label item-left class="text-dark" *ngIf="item.online_only==1">Solo Online</ion-label>
            </ion-col>
            <ion-col text-right>
              <ion-label item-right class="text-primary font-more-small terms" (click)="updateShowTerms(item)">Términos y condiciones</ion-label>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="showTerms == item.id_product">
            <div class="inner-html padding-5" [innerHTML]="item.description_short" [@slideIn]></div>
          </ion-row>
        </div>
      </div>
    </ion-grid>
    <div class="cart-values text-dark">
      <ion-list>
<!--        <ion-item>
          <ion-label class="font-small">Subtotal:</ion-label>
          <ion-label class="font-small" text-right>{{cart.format_total_products}}</ion-label>
        </ion-item>-->
<!--        <ion-item>
          <ion-label class="font-small">Valor:</ion-label>
          <ion-label class="font-small"text-right>{{cart.format_total_products_wt}}</ion-label>
        </ion-item>-->
      </ion-list>
      <ion-list>
        <ion-item>
          <ion-label class="font-small">PRECIO TOTAL:</ion-label>
          <ion-label class="font-small" text-right>{{cart.format_order_total}}</ion-label>
        </ion-item>
      </ion-list>
<!--      <ion-list>
        <ion-item>
          <ion-label class="font-more-small">PRECIO EN FLUZ:</ion-label>
          <ion-label class="font-small" text-right>{{cart.total_price_in_points}}</ion-label>
        </ion-item>
      </ion-list>-->
      <ion-list *ngIf="discounts"> 
        <ion-item *ngFor="let item of discounts">
          <ion-label class="font-more-small">FLUZ APLICADOS:</ion-label>
          <ion-label class="font-small" text-right>{{item.value_real / 25}}</ion-label>
        </ion-item>
      </ion-list>
      <ion-list>
        <ion-item *ngIf="showSavings">
          <ion-label class="font-more-small text-primary">TUS AHORROS:</ion-label>
          <ion-label class="font-small text-primary" text-right>${{cart.total_savings_in_value}} ({{cart.total_savings_in_percent}}%)</ion-label>
        </ion-item>
        <ion-item>
          <ion-label class="font-more-small text-primary">FLUZ GANADOS:</ion-label>
          <ion-label class="font-small text-primary" text-right>+ {{cart.total_fluz/2}}</ion-label>
        </ion-item>
        <ion-item>
          <ion-label class="font-more-small text-primary">PRECIO EN FLUZ:</ion-label>
          <ion-label class="font-small text-primary" text-right>+ {{cart.app_total_price_in_points}}</ion-label>
        </ion-item>
      </ion-list>
    </div>
    <div class="spacer-25"></div>
  </div>
  <div class="spacer-25"></div>
</ion-content>

<ion-footer>
  <ion-toolbar color="primary"  *ngIf="!cart.quantity" navPop>
    <ion-title>Volver</ion-title>
  </ion-toolbar>
  <ion-toolbar color="primary"  *ngIf="cart.quantity > 0" (click)="goTo('checkoutPage')">
    <ion-title>PAGAR</ion-title>
  </ion-toolbar>
</ion-footer>
